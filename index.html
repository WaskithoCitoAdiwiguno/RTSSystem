<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat and Risk Scoring System</title>
    <link href="/src/css/index.css" rel="stylesheet">

</head>
<body>
    <h1>Risk and Threat Scoring System</h1>

    <div class="form-container">
        <h2>Input Threat</h2>
        <label for="threatName">Threat Name</label>
        <input type="text" id="threatName" placeholder="Enter threat name" required>

        <label for="strideCategory">STRIDE Category</label>
        <select id="strideCategory">
            <option value="Spoofing">Spoofing</option>
            <option value="Tampering">Tampering</option>
            <option value="Repudiation">Repudiation</option>
            <option value="Information Disclosure">Information Disclosure</option>
            <option value="Denial of Service">Denial of Service</option>
            <option value="Elevation of Privilege">Elevation of Privilege</option>
        </select>

        <label for="dreadScore">DREAD Score (0-10)</label>
        <input type="number" id="dreadScore" placeholder="Enter risk score (0-10)" min="0" max="10" required>

        <button onclick="addThreat()">Add Threat</button>
    </div>

    <div class="search-container">
        <h2>Search Threat</h2>
        <select id="searchDropdown" onchange="filterThreats()">
            <option value="">-- Select STRIDE Category --</option>
            <option value="Spoofing">Spoofing</option>
            <option value="Tampering">Tampering</option>
            <option value="Repudiation">Repudiation</option>
            <option value="Information Disclosure">Information Disclosure</option>
            <option value="Denial of Service">Denial of Service</option>
            <option value="Elevation of Privilege">Elevation of Privilege</option>
        </select>

        <h2>Filter by Risk Level</h2>
        <select id="riskLevelDropdown" onchange="filterByRiskLevel()">
            <option value="">-- Select Risk Level --</option>
            <option value="Low Risk">Low Risk</option>
            <option value="Medium Risk">Medium Risk</option>
            <option value="High Risk">High Risk</option>
        </select>
    </div>

    <table id="threatTable">
        <thead>
            <tr>
                <th>Threat Name</th>
                <th>STRIDE Category</th>
                <th>DREAD Score</th>
                <th>Risk Level</th>
                <th>Mitigation Recommendation</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <button class="export-button" onclick="exportToCSV()">Export to CSV</button>
    <button class="export-button" onclick="generatePDFReport()">Export to PDF</button>

    <div class="statistics-container">
        <h2>Threat Statistics</h2>
        <ul>
            <li>Total Threats: <span id="totalThreats">0</span></li>
            <li>Total High Risk Threats: <span id="highRiskThreats">0</span></li>
            <li>Total Medium Risk Threats: <span id="mediumRiskThreats">0</span></li>
            <li>Total Low Risk Threats: <span id="lowRiskThreats">0</span></li>
            <li>Most Severe Threat: <span id="mostSevereThreat">N/A</span></li>
        </ul>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="src/js/index.js"></script>
</body>
</html>
